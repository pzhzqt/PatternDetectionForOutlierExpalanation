create table StockData(
ticker varchar(15),
date date,
open decimal,
high decimal,
low decimal,
close decimal,
adj_close decimal,
volume decimal
);


COPY StockData FROM 'dataAll.csv' WITH (FORMAT csv);


create table stock(
ticker varchar(15),
date date,
month decimal,
day decimal,
year decimal,
open decimal,
high decimal,
low decimal,
close decimal,
adj_close decimal,
volume decimal
);


insert into stock (ticker, date, month, day, year, open ,  high ,  low , close, volume , adj_close  ) 
select sd.ticker, sd.date, 
EXTRACT(MONTH FROM sd.date) as month, 
EXTRACT(DAY FROM sd.date) as day, 
EXTRACT(YEAR FROM sd.date) as year, 
sd.open ,  sd.high ,  sd.low ,  sd.volume  , sd.close , sd.adj_close
from StockData as sd


date date,
open decimal,
high decimal,
low decimal,
close decimal,
adjclose decimal,
volume decimal
